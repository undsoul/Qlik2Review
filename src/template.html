<div class="qlik2review-container"
     ng-style="{
       'background-color': layout.appearance.backgroundColor || '#ffffff',
       'color': layout.appearance.textColor || '#333333'
     }">

  <!-- Header Section -->
  <div class="q2r-header">
    <div class="q2r-title">
      <span class="q2r-icon">&#9733;</span>
      <span>Qlik2Review</span>
    </div>
    <div class="q2r-actions">
      <button class="q2r-btn q2r-btn-primary"
              ng-click="analyzeSheet()"
              ng-disabled="isAnalyzing"
              ng-style="{'background-color': layout.appearance.accentColor || '#009845'}">
        <span ng-if="!isAnalyzing">Analyze Sheet</span>
        <span ng-if="isAnalyzing">Analyzing...</span>
      </button>
      <button class="q2r-btn q2r-btn-secondary"
              ng-click="clearSummaries()"
              ng-disabled="isAnalyzing || !sheetSummary">
        Clear
      </button>
    </div>
  </div>

  <!-- Error Display -->
  <div class="q2r-error" ng-if="error">
    <span class="q2r-error-icon">&#9888;</span>
    <span>{{error}}</span>
  </div>

  <!-- Timestamp -->
  <div class="q2r-timestamp" ng-if="lastUpdated && layout.appearance.showTimestamp !== false">
    Last updated: {{formatTimestamp(lastUpdated)}}
  </div>

  <!-- Sheet Summary Section -->
  <div class="q2r-section" ng-if="layout.outputSettings.showSheetSummary !== false && sheetSummary">
    <div class="q2r-section-header">
      <span class="q2r-section-icon">&#128202;</span>
      <span>Sheet Summary</span>
    </div>
    <div class="q2r-summary-content"
         ng-class="'q2r-font-' + (layout.appearance.fontSize || 'medium')">
      {{sheetSummary}}
    </div>
  </div>

  <!-- Object Summaries Section -->
  <div class="q2r-section" ng-if="layout.outputSettings.showObjectList !== false && objectSummaries.length > 0">
    <div class="q2r-section-header">
      <span class="q2r-section-icon">&#128200;</span>
      <span>Object Insights ({{objectSummaries.length}})</span>
    </div>
    <div class="q2r-objects-list">
      <div class="q2r-object-item"
           ng-repeat="obj in objectSummaries track by obj.id"
           ng-class="{'q2r-object-error': obj.error}">
        <div class="q2r-object-header">
          <span class="q2r-object-type" ng-style="{'border-color': layout.appearance.accentColor || '#009845'}">
            {{obj.type}}
          </span>
          <span class="q2r-object-title">{{obj.title}}</span>
        </div>
        <div class="q2r-object-summary"
             ng-class="'q2r-font-' + (layout.appearance.fontSize || 'medium')">
          {{obj.summary}}
        </div>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div class="q2r-empty" ng-if="!sheetSummary && !isAnalyzing && !error">
    <div class="q2r-empty-icon">&#128269;</div>
    <div class="q2r-empty-text">Click "Analyze Sheet" to generate AI-powered insights</div>
    <div class="q2r-empty-hint">Configure your AI provider in the extension properties</div>
  </div>

  <!-- Loading State -->
  <div class="q2r-loading" ng-if="isAnalyzing">
    <div class="q2r-spinner"></div>
    <div class="q2r-loading-text">Analyzing sheet objects...</div>
  </div>

</div>
